---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

--> <https://medium.com/swlh/t-sne-explained-math-and-intuition-94599ab164cf>

```{r, setup}
#DIRECTORIES
root_proj_dir = "../../"
dataset_path = paste(root_proj_dir,"data/pisa_score_woo.csv",sep="")
include_path = paste(root_proj_dir,"src/include/Utilities.R",sep="")
#INCLUDING UTILITIES
source(include_path)
#IMPORTING THE DATASET
pisa_data <- read.csv(file=dataset_path)
head(pisa_data)
library(rgl)
library(Rtsne)
```
```{r}

pisa_data$X <- NULL
pisa_data$CNT <- as.factor(pisa_data$CNT)
pisa_data$IM_PUBLIC <- as.factor(pisa_data$IM_PUBLIC)
pisa_data$NEW_VAR <- as.factor(pisa_data$NEW_VAR)
countrys =pisa_data$CNT 

pisa_data_cut = as.data.frame(scale(select_if(pisa_data,is.numeric)))

perplex = c(1,30,50)

pdf("high dimensionality plots.pdf")

for(k in perplex){
  
  tsne_results <- Rtsne(pisa_data_cut, perplexity=k, check_duplicates = FALSE, pca=FALSE)
  title = paste("Perplexity = ", k)
  plot(tsne_results$Y[,1],tsne_results$Y[,2], col = "black", bg= countrys, pch = 21, cex = 1, main = title)
  
}
dev.off()
```
# Chosen perplexity = 30
```{r}
tsne_results <- Rtsne(pisa_data_cut,dim=2, perplexity=30, check_duplicates = FALSE, pca=FALSE)
```

# plot
```{r}
#x11()
countrys =pisa_data$CNT 
countrys_num <- as.numeric(countrys)
public_num <- as.numeric(public)
plot(tsne_results$Y[,1],tsne_results$Y[,2],col=countrys_num, main = "Perplexity = 30",pch =(countrys_num+10))
legend("topright", legend = unique(countrys), col = unique(countrys_num), pch = unique(countrys_num+10),ncol=2)
```


```{r}
tsne_results_3d <- Rtsne(pisa_data_cut,dim=3, perplexity=30, check_duplicates = FALSE, pca=FALSE)

plot3d(tsne_results_3d$Y, pch = 19, cex = 2, col = countrys_num, main = "Perplexity = 30")

```


