---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

--> <https://medium.com/swlh/t-sne-explained-math-and-intuition-94599ab164cf>

```{r, setup}
#DIRECTORIES
root_proj_dir = "../../"
dataset_path = paste(root_proj_dir,"data/df_pca_scores.csv",sep="")
include_path = paste(root_proj_dir,"src/include/Utilities.R",sep="")
#INCLUDING UTILITIES
source(include_path)
#IMPORTING THE DATASET
pisa_data <- read.csv(file=dataset_path)
head(pisa_data)
library(rgl)
library(Rtsne)
```
```{r}
countrys = as.factor(pisa_data$CNT)
pisa_data_cut = pisa_data[,3:(dim(pisa_data)[2]-1)]

perplex = c(1,30,50)

pdf("high dimensionality plots.pdf")

for(k in perplex){
  
  tsne_results <- Rtsne(pisa_data_cut, perplexity=k, check_duplicates = FALSE, pca=FALSE)
  title = paste("Perplexity = ", k)
  plot(tsne_results$Y[,1],tsne_results$Y[,2], col = "black", bg= countrys, pch = 21, cex = 1, main = title)
  
}
dev.off()
```
```{r}
tsne_results <- Rtsne(pisa_data_cut,dim=2, perplexity=30, check_duplicates = FALSE, pca=FALSE)
countrys_num <- as.numeric(countrys)
plot(tsne_results$Y,col=countrys_num, main = "Perplexity = 30")
```


```{r}
tsne_results_3d <- Rtsne(pisa_data_cut,dim=3, perplexity=30, check_duplicates = FALSE, pca=FALSE)

plot3d(tsne_results_3d$Y, pch = 19, cex = 2, col = countrys_num, main = "Perplexity = 30")

```


